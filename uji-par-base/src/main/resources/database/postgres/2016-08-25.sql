ALTER TABLE PAR_CINES ADD COLUMN URL_PUBLIC VARCHAR(255);
ALTER TABLE PAR_CINES ADD COLUMN URL_PRIVACIDAD VARCHAR(255);
ALTER TABLE PAR_CINES ADD COLUMN URL_COMO_LLEGAR VARCHAR(255);
ALTER TABLE PAR_CINES ADD COLUMN MAIL_FROM VARCHAR(255);
ALTER TABLE PAR_CINES ADD COLUMN URL_PIE_ENTRADA VARCHAR(255);
ALTER TABLE PAR_CINES ADD COLUMN LOGO_REPORT VARCHAR(255);

ALTER TABLE PAR_MAILS ADD COLUMN URL_PUBLIC VARCHAR(255) NOT NULL;
ALTER TABLE PAR_MAILS ADD COLUMN URL_PIE_ENTRADA VARCHAR(255) NOT NULL;

--Rellenar y hacer no nulas
--ALTER TABLE PAR_CINES MODIFY URL_PUBLIC DEFAULT NULL NOT NULL;
--ALTER TABLE PAR_CINES MODIFY URL_PRIVACIDAD DEFAULT NULL NOT NULL;
--ALTER TABLE PAR_CINES MODIFY URL_COMO_LLEGAR DEFAULT NULL NOT NULL;
--ALTER TABLE PAR_CINES MODIFY MAIL_FROM DEFAULT NULL NOT NULL;
--ALTER TABLE PAR_CINES MODIFY URL_PIE_ENTRADA DEFAULT NULL NOT NULL;
--ALTER TABLE PAR_CINES MODIFY LOGO_REPORT DEFAULT NULL NOT NULL;
--ALTER TABLE PAR_MAILS MODIFY URL_PUBLIC DEFAULT NULL NOT NULL;
--ALTER TABLE PAR_MAILS MODIFY URL_PIE_ENTRADA DEFAULT NULL NOT NULL;

CREATE TABLE PAR_TPVS_CINES
(
  ID SERIAL UNIQUE,
  TPV_ID INTEGER NOT NULL,
  CINE_ID INTEGER NOT NULL,
  CONSTRAINT PAR_TPVS_CINES_PK PRIMARY KEY (ID),
  CONSTRAINT PAR_TPVS_CINES_UQ UNIQUE (TPV_ID, CINE_ID),
  CONSTRAINT PAR_TPVS_CINES_TPV_FK FOREIGN KEY (TPV_ID)
  REFERENCES PAR_TPVS (ID) ON DELETE CASCADE,
  CONSTRAINT PAR_TPVS_CINES_CINE_FK FOREIGN KEY (CINE_ID)
  REFERENCES PAR_CINES (ID) ON DELETE CASCADE
);

ALTER TABLE PAR_TPVS DROP COLUMN default_tpv;

INSERT INTO par_version_bbdd (VERSION) VALUES ('2016-08-25.SQL');